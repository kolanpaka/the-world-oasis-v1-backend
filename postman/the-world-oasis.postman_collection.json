{
	"info": {
		"_postman_id": "232985e5-b2e6-44a5-a2d0-d77572fc471f",
		"name": "the-world-oasis",
		"description": "LIVE ON\n\n[https://the-world-oasis-v1-backend-1.onrender.com](https://the-world-oasis-v1-backend-1.onrender.com/)\n\n# üåç **The World Oasis ‚Äî Full-Stack Cabin Booking & Management System**\n\nWelcome to **The World Oasis**, a powerful and modular cabin booking platform built for both customers and administrative teams.\n\nIt offers a smooth booking experience for users while providing advanced management tools for admins and super admins.\n\nThis app features:\n\n- Secure user authentication\n    \n- Role-based access control\n    \n- Cabin management\n    \n- Booking engine\n    \n- User self-service portal\n    \n- Admin dashboard with analytics\n    \n- System settings\n    \n- Strong booking validation rules\n    \n- Multi-facet aggregated insights\n    \n\nEvery module is designed with clarity, privacy, and reliability in mind.\n\n---\n\n# üöÄ **What This App Provides**\n\n### ‚úî A complete booking system\n\nUsers can browse cabins, create reservations, manage their bookings, update their profile, and more.\n\n### ‚úî Full administrative controls\n\nAdmins and Super Admins can:\n\n- Manage cabins\n    \n- Handle check-ins & check-outs\n    \n- View business insights\n    \n- Moderate user accounts\n    \n- Enforce policies & settings\n    \n\n### ‚úî Real-world business features\n\nThe platform supports:\n\n- Minimum & maximum nights\n    \n- Breakfast add-on pricing\n    \n- Booking duration rules\n    \n- Capacity validation\n    \n- Overlapping booking prevention\n    \n- Automatic pricing calculations\n    \n\n---\n\n# üß≠ **How to Use This App**\n\n### üë§ **For Users**\n\n- Sign up\n    \n- Sign in\n    \n- Browse cabins\n    \n- Create bookings\n    \n- Manage all bookings in **My Bookings**\n    \n- Update profile or password\n    \n- Cancel upcoming bookings\n    \n\n### üõ†Ô∏è **For Admin**\n\n- Manage all bookings\n    \n- Check-in / Check-out guests\n    \n- View dashboard analytics\n    \n- Maintain cabin data\n    \n\n### üèÜ **For Super Admin**\n\n- Full authority over the entire system\n    \n- Manage users and roles\n    \n- Manage cabins\n    \n- Update global system settings\n    \n- Access full analytics\n    \n- Fix/adjust bookings\n    \n\n---\n\n# ‚ú® **Key Features**\n\n### üîí Role-Based Security\n\nThree permission levels:\n\n- **User** ‚Äî customer-facing tools\n    \n- **Admin** ‚Äî operational tools\n    \n- **Super Admin** ‚Äî full control\n    \n\n### üèò Cabin Management\n\nSuper Admin and Admin can:\n\n- Create, update, delete cabins\n    \n- Manage cabin capacity, pricing, images, discounts\n    \n\n### üìÖ Booking Engine\n\nSupports:\n\n- Start & end dates\n    \n- Guest count\n    \n- Breakfast option\n    \n- Observations/notes\n    \n\nAutomatically validates:\n\n- Date overlap\n    \n- Stay duration\n    \n- Cabin availability\n    \n- User role/activity\n    \n- Capacity limits\n    \n\n### üí∞ Smart Pricing\n\nThe system auto-calculates:\n\n- Base sales\n    \n- Discount adjustments\n    \n- Breakfast charges\n    \n- Total sales\n    \n\n### üìä Admin Dashboard\n\nOne endpoint returns all insights:\n\n- Total bookings\n    \n- Total check-ins\n    \n- Sales grouped by date\n    \n- Occupancy rate\n    \n- Stay duration summary\n    \n- Daily guest movements\n    \n\n### ‚öô System Settings\n\nSuper Admin can configure:\n\n- Minimum nights\n    \n- Maximum nights\n    \n- Breakfast price\n    \n\n### üë§ Accounts & Profiles\n\nUsers can:\n\n- Update profile\n    \n- Edit username/email\n    \n- Upload/change profile image\n    \n- Change password\n    \n- Sign out from one or all devices\n    \n\n---\n\n# üß† **Special Facts About This Application**\n\n### ‚úî Admin & User booking routes are completely separated\n\nUsers can only access **My Bookings**, not admin booking tools.\n\n### ‚úî 404 is used to hide other users' bookings\n\nEven if users try to guess booking IDs, the system hides all unauthorized resources.\n\n### ‚úî Dashboard uses an efficient multi-facet aggregation pipeline\n\nAll analytics load in one fast request.\n\n### ‚úî Cloudinary integration for media uploads\n\nProfile pictures and cabin images stored securely.\n\n### ‚úî Clean RESTful API\n\nModules include:\n\n- `/auth`\n    \n- `/users`\n    \n- `/cabins`\n    \n- `/bookings` (admin)\n    \n- `/my-bookings` (user)\n    \n- `/settings`\n    \n- `/dashboard`\n    \n- `/account`\n    \n\n---\n\n# üéâ **In Summary**\n\n**The World Oasis** is a fully featured, secure, business-ready cabin booking platform that delivers:\n\n- Smooth user experience\n    \n- Powerful admin controls\n    \n- Accurate analytics\n    \n- Clear role boundaries\n    \n- Strong security\n    \n- Real-world booking logic\n    \n\nBuilt with structure, scalability, and professional standards in mind.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "28952830"
	},
	"item": [
		{
			"name": "Cabins",
			"item": [
				{
					"name": "get cabin",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/cabins/68cbb2936c7dae7b9b06239b",
							"host": [
								"{{URL}}"
							],
							"path": [
								"cabins",
								"68cbb2936c7dae7b9b06239b"
							]
						},
						"description": "**`GET /cabins/:cabinID`**\n\n- Returns complete information about the cabin, including its name, capacity, image, price, discount, and description.\n    \n- Requires authentication.\n    \n- Accessible to **admins**, **super admins**, and **regular users** (read-only)."
					},
					"response": []
				},
				{
					"name": "get all cabins",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var template = `\r",
									"<style type=\"text/css\">\r",
									"    .tftable {font-size:14px;color:#333333;width:100%;border-width: 1px;border-color: #87ceeb;border-collapse: collapse;}\r",
									"    .tftable th {font-size:18px;background-color:#87ceeb;border-width: 1px;padding: 8px;border-style: solid;border-color: #87ceeb;text-align:left;}\r",
									"    .tftable tr {background-color:#ffffff;}\r",
									"    .tftable td {font-size:14px;border-width: 1px;padding: 8px;border-style: solid;border-color: #87ceeb;}\r",
									"    .tftable tr:hover {background-color:#e0ffff;}\r",
									"</style>\r",
									"\r",
									"<table class=\"tftable\" border=\"1\">\r",
									"    <tr>\r",
									"        <th>ID</th>\r",
									"        <th>Cabin</th>\r",
									"        <th>Capacity</th>\r",
									"        <th>Price</th>\r",
									"        <th>Discount</th>\r",
									"        <th>Description</th>\r",
									"    </tr>\r",
									"    \r",
									"    {{#each response.data.cabins}}\r",
									"        <tr>\r",
									"            <td>{{_id}}</td>\r",
									"            <td>{{cabin}}</td>\r",
									"            <td>{{capacity}}</td>\r",
									"            <td>{{price}}</td>\r",
									"            <td>{{Discount}}</td>\r",
									"            <td>{{description}}</td>\r",
									"        </tr>\r",
									"    {{/each}}\r",
									"</table>\r",
									"`;\r",
									"\r",
									"function constructVisualizerPayload() {\r",
									"    return {response: pm.response.json()};\r",
									"}\r",
									"\r",
									"pm.visualizer.set(template, constructVisualizerPayload());"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/cabins",
							"host": [
								"{{URL}}"
							],
							"path": [
								"cabins"
							]
						},
						"description": "# üìò **GET /cabins ‚Äì Retrieve All Cabins**\n\nThis endpoint returns a list of all cabins.  \n  \nSupports **query filters** and **sorting** for flexible retrieval.\n\n---\n\n## üîç **Query Parameters**\n\n---\n\n## **1\\.** **`discount`** **(optional)**\n\nFilter cabins based on discount availability.\n\n### **Available Values**\n\n| Value | Meaning |\n| --- | --- |\n| `no-discount` | Only cabins with **0% discount** |\n| `with-discount` | Only cabins **having a discount** |\n| `all` (default) | Returns **all cabins** |\n\n### **2\\.** **`sortBy`** **(optional)**\n\nSort cabins based on name, price, or capacity.\n\n### **Available Values**\n\n| Value | Sorts By | Order |\n| --- | --- | --- |\n| `name-asc` | cabin name | A ‚Üí Z |\n| `name-desc` | cabin name | Z ‚Üí A |\n| `regularPrice-asc` | price | low ‚Üí high |\n| `regularPrice-desc` | price | high ‚Üí low |\n| `maxCapacity-asc` | capacity | low ‚Üí high |\n| `maxCapacity-desc` | capacity | high ‚Üí low |\n\n---\n\n## üìå **Example Requests**\n\n### **Filter cabins with discount**\n\n```\nGET /cabins?discount=with-discount\n\n ```\n\n### **Sort by price (low ‚Üí high)**\n\n```\nGET /cabins?sortBy=regularPrice-asc\n\n ```\n\n### **Filter + sort**\n\n```\nGET /cabins?discount=no-discount&sortBy=name-desc\n\n ```\n\n---\n\n## üì§ **Response**\n\n- Returns an array of cabin objects.\n    \n- Each cabin includes:  \n    `cabinName`, `capacity`, `cabinImage`, `price`, `discount`, `description`."
					},
					"response": []
				},
				{
					"name": "update Cabin",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"cabin\":\"909\",\"capacity\":1,\"Discount\":90,\"price\":80,\"cabin_image\":\"https://amoeidozdmndtgzcmxdc.supabase.co/storage/v1/object/public/cabin-images/cabin-005.jpg\",\"description\":\"Enjoy a comfortable and cozy getaway with your group or family in our spacious cabin 005. Designed to accommodate up to 6 people, this cabin offers a secluded retreat in the heart of nature. Inside, the cabin features warm and inviting interiors crafted from quality wood, a living area with fireplace, and a fully-equipped kitchen. The bedrooms are comfortable and equipped with en-suite bathrooms. Step outside to your private deck and take in the natural surroundings while relaxing in your own hot tub.\"}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/cabins/68cbb2936c7dae7b9b062399",
							"host": [
								"{{URL}}"
							],
							"path": [
								"cabins",
								"68cbb2936c7dae7b9b062399"
							]
						},
						"description": "need to pass every parameter to update the cabin unlike patch request (IGNOREü§∑)"
					},
					"response": []
				},
				{
					"name": "Delete Cabin",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{URL}}/cabins/691030885f4fdf6606c2cf08",
							"host": [
								"{{URL}}"
							],
							"path": [
								"cabins",
								"691030885f4fdf6606c2cf08"
							]
						},
						"description": "# üóëÔ∏è **Delete a Cabin**\n\n### **`DELETE /cabins/:cabinID`**\n\n---\n\n## üöÄ **Delete an Existing Cabin**\n\nDeletes a cabin permanently from the system.\n\nThis action is restricted to **Admins** and **Super Admins** only.\n\nAuthentication is **required**.\n\n---\n\n## üîê **Permissions**\n\n| Role | Access |\n| --- | --- |\n| Admin | ‚úî Can delete cabin |\n| Super Admin | ‚úî Can delete cabin |\n| Regular User | ‚ùå Cannot delete cabin |\n\n---\n\n## üì• **Request Parameters**\n\n### **Path Parameter**\n\n| Name | Type | Description |\n| --- | --- | --- |\n| `cabinID` | String | ID of the cabin to delete |\n\n---\n\n## üìå **Example Request**\n\n```\nDELETE /cabins/691030885f4fdf6606c2cf08\n\n ```"
					},
					"response": []
				},
				{
					"name": "create cabin",
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {}
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"disabled": true
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "cabin",
									"value": "cabin0022",
									"type": "text"
								},
								{
									"key": "capacity",
									"value": "2",
									"type": "text"
								},
								{
									"key": "price",
									"value": "6500",
									"type": "text"
								},
								{
									"key": "Discount",
									"value": "800",
									"type": "text"
								},
								{
									"key": "description",
									"value": " Experience a family-friendly retreat in cabin 002, featuring spacious interiors and a beautiful view of the forest. This cabin is perfect for groups, with a cozy living room, modern kitchen, and outdoor space for barbecues and relaxation.",
									"type": "text"
								},
								{
									"key": "cabin_image",
									"type": "file",
									"src": "/C:/D backup/js projects/ultimate-react-course-main/ultimate-react-course-main/17-the-wild-oasis/starter/data/cabins/cabin-001.jpg"
								}
							]
						},
						"url": {
							"raw": "{{URL}}/cabins",
							"host": [
								"{{URL}}"
							],
							"path": [
								"cabins"
							]
						},
						"description": "# üè° **Create a New Cabin**\n\n### **`POST /cabins`**\n\n---\n\n## ‚ú® **Create Cabin**\n\nThis endpoint allows **Admins** and **Super Admins** to create a new cabin in the system.  \n  \nRegular users **cannot** create cabins.  \n  \nAuthentication is **mandatory**.\n\n---\n\n## üîê **Permissions**\n\n| Role | Access |\n| --- | --- |\n| Admin | ‚úî Can create cabin |\n| Super Admin | ‚úî Can create cabin |\n| Regular User | ‚ùå Cannot create cabin |\n\n---\n\n## üì• **Required Request Body**\n\nThe request should contain all essential cabin details.\n\n| Field | Type | Required | Description |\n| --- | --- | --- | --- |\n| `cabinName` | String | Yes | Name/title of the cabin |\n| `capacity` | Number | Yes | Maximum number of guests |\n| `price` | Number | Yes | Regular price of the cabin |\n| `discount` | Number | Yes | Discount price (0 if none) |\n| `description` | String | Yes | Full cabin details |\n| `cabinImage` | File | Yes | Image file (handled via Multer + Cloudinary) |\n\n---\n\n## üìå **Request Example (Form-Data)**\n\n**Content-Type:** `multipart/form-data`\n\n| Key | Value (Example) | Type |\n| --- | --- | --- |\n| cabinName | \"Luxury Lake View Cabin\" | Text |\n| capacity | 4 | Text |\n| price | 6800 | Text |\n| discount | 5 | Text |\n| description | \"Beautiful cabin beside the lake\" | Text |\n| cabinImage | (upload file) | File |\n\n---\n\n## üì§ **Example Success Response (201 Created)**\n\n```\n{\n  \"status\": \"success\",\n  \"message\": \"Cabin created successfully\",\n  \"data\": {\n    \"_id\": \"68ccb8f86a49e55fb3f91b23\",\n    \"cabinName\": \"Luxury Lake View Cabin\",\n    \"capacity\": 4,\n    \"price\": 6800,\n    \"discount\": 5,\n    \"description\": \"Beautiful cabin beside the lake\",\n    \"cabinImage\": \"https://res.cloudinary.com/.../lakeview.jpg\"\n  }\n}\n\n ```\n\n---"
					},
					"response": []
				},
				{
					"name": "update cabin instant",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "cabin",
									"value": "00989",
									"type": "text"
								},
								{
									"key": "cabin_image",
									"type": "file",
									"src": "/C:/D backup/js projects/ultimate-react-course-main/ultimate-react-course-main/17-the-wild-oasis/starter/data/cabins/cabin-008.jpg"
								}
							]
						},
						"url": {
							"raw": "{{URL}}/cabins/68cbb2936c7dae7b9b06239b",
							"host": [
								"{{URL}}"
							],
							"path": [
								"cabins",
								"68cbb2936c7dae7b9b06239b"
							]
						},
						"description": "### **Update a Cabin**\n\n**`PATCH /cabins/:cabinID`**\n\n---\n\n# üõ†Ô∏è **Update an Existing Cabin**\n\n### **Endpoint**\n\n**`PATCH /cabins/:cabinID`**\n\nUpdates the details of an existing cabin.\n\nOnly **Admin** and **Super Admin** roles are allowed to perform this action.\n\nAuthentication is **required**.\n\n---\n\n## üîê **Permissions**\n\n| Role | Access |\n| --- | --- |\n| Admin | ‚úî Can update cabin |\n| Super Admin | ‚úî Can update cabin |\n| Regular User | ‚ùå Cannot update cabin |\n\n---\n\n## üì• **Request Parameters**\n\n### **Path Parameter**\n\n| Name | Type | Description |\n| --- | --- | --- |\n| `cabinID` | String | The ID of the cabin you want to update |\n\n---\n\n## üìù **Request Body (Any of the following fields)**\n\nSend only the fields you want to update.\n\n| Field | Type | Description |\n| --- | --- | --- |\n| `cabinName` | String | Name/title of the cabin |\n| `capacity` | Number | Maximum occupancy |\n| `price` | Number | Regular price of the cabin |\n| `discount` | Number | Discount on the price |\n| `description` | String | Detailed cabin information |\n| `cabinImage` | File/URL | New cabin image (if updating image) |\n\n---\n\n## üìå **Example Request**\n\n```\nPATCH /cabins/68cbb2936c7dae7b9b062399\nContent-Type: application/json\n{\n  \"cabinName\": \"Luxury Forest Retreat\",\n  \"capacity\": 4,\n  \"price\": 7500,\n  \"discount\": 10,\n  \"description\": \"A premium cabin located deep inside the forest with modern amenities.\"\n}\n\n ```\n\n---\n\n## üì§ **Example Success Response (200 OK)**\n\n``` json\n{\n  \"status\": \"success\",\n  \"message\": \"Cabin updated successfully\",\n  \"data\": {\n    \"_id\": \"68cbb2936c7dae7b9b062399\",\n    \"cabinName\": \"Luxury Forest Retreat\",\n    \"capacity\": 4,\n    \"price\": 7500,\n    \"discount\": 10,\n    \"description\": \"A premium cabin located deep inside the forest with modern amenities.\",\n    \"cabinImage\": \"https://res.cloudinary.com/.../updatedImage.jpg\"\n  }\n}\n\n ```\n\n---\n\n## ‚ùó **Error Responses**\n\n| Status | Meaning | Reason |\n| --- | --- | --- |\n| 400 | Bad Request | Invalid body data |\n| 401 | Unauthorized | Missing/invalid token |\n| 403 | Forbidden | User is not admin/super admin |\n| 404 | Not Found | Cabin not found for the given ID |\n\n---"
					},
					"response": []
				}
			],
			"description": "### **Cabins Module Overview**\n\n<img src=\"https://content.pstmn.io/265c2b9d-e020-4d89-b1ba-69d3b203e962/Y2FiaW4tMDAxLmpwZw==\">\n\nIn **The World Oasis** project, cabins represent individual accommodation units available for users to browse and book. Each cabin is stored as a structured resource containing essential information that helps users understand its features and suitability.\n\n#### **Cabin Attributes**\n\nA cabin includes the following key fields:\n\n- **cabinName** ‚Äî The name or title of the cabin.\n    \n- **capacity** ‚Äî The maximum number of guests the cabin can accommodate.\n    \n- **cabinImage** ‚Äî A representative image of the cabin (stored via Cloudinary or similar).\n    \n- **price** ‚Äî The base price for booking the cabin.\n    \n- **discount** ‚Äî Any applicable discount on the cabin price.\n    \n- **description** ‚Äî A detailed explanation outlining the cabin's features, ambiance, amenities, and suitability.\n    \n\nThese fields together represent the complete structure of a cabin resource.\n\n---\n\n### **Access Control & Permissions**\n\nTo maintain system integrity and ensure proper management:\n\n- **Admins and Super Admins**\n    \n    - Can **create**, **update**, and **delete** cabins.\n        \n    - Have full access to cabin management endpoints.\n        \n- **Regular Users**\n    \n    - Can **only read** cabin data.\n        \n    - No permission to create, modify, or delete cabins.\n        \n\n---\n\n### **Authentication**\n\nAuthentication is **mandatory** for accessing any cabin-related operations.\n\n- Admin/Super Admin privileges are required for write operations.\n    \n- Authenticated users can perform read-only actions."
		},
		{
			"name": "users",
			"item": [
				{
					"name": "post user",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"disabled": true
							}
						],
						"body": {
							"mode": "raw",
							"raw": "\r\n{\r\n  \"userName\": \"Kalyan\",\r\n  \"email\": \"kalyan@example.com\",\r\n  \"password\": \"Test@1234\",\r\n  \"role\": \"admin\",\r\n  \"country\": \"India\",\r\n  \"countryCode\": \"+91\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/users",
							"host": [
								"{{URL}}"
							],
							"path": [
								"users"
							]
						},
						"description": "StartFragment\n\n# üìù **Create User ‚Äî How It Works**\n\nThe **POST /users** endpoint is used to create a new user account within the system.  \n  \nThis operation is protected and restricted based on user roles.\n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### ‚úÖ **Super Admin (spadmin)**\n\nSuper Admins have the highest level of permission. They can:\n\n- Create **any type** of user (user, admin, or super admin)\n    \n\n### ‚úÖ **Admin**\n\nAdmins can also create users, but with restrictions:\n\n- They **can create**:\n    \n    - regular users\n        \n    - admin users\n        \n- They **cannot create**:\n    \n    - **super admin (spadmin)** users  \n          \n        This is blocked to prevent privilege escalation.\n        \n\n### ‚ùå **Regular Users**\n\nRegular users cannot create new accounts and do not have access to this endpoint.\n\n---\n\n# üîê **Why the Restriction Exists**\n\nCreating a **super admin** is a highly sensitive action.  \n  \nAdmins are not allowed to assign that role, because it would give them:\n\n- Full system control\n    \n- Access to every user\n    \n- Ability to delete admins\n    \n- Permission to modify restricted records\n    \n\nOnly an existing **super admin** can create another super admin.  \n  \nThis prevents misuse of power and keeps the system secure.\n\n---\n\n# üöÄ **How to Use This Endpoint**\n\n### 1\\. **Send a POST request to:**\n\n```\nPOST /users\n\n ```\n\n### 2\\. **Include a valid authentication token**\n\nThe sender must be an **admin** or **super admin**.\n\n### 3\\. **Provide user details in JSON format**\n\n```\n{\n  \"userName\": \"Kavya Reddy\",\n  \"email\": \"kavya@example.com\",\n  \"password\": \"StrongPass@123\",\n  \"role\": \"user\",\n  \"country\": \"India\",\n  \"countryCode\": \"+91\"\n}\n\n ```\n\n### **Note:**\n\nA default profile image is assigned automatically . profile can be edited after sigin in into the account or spadmin can edit through patch request\n\n---\n\n# ‚ö†Ô∏è **What Admin Is** _**Not**_ **Allowed to Do**\n\n| Action | Admin Allowed? | Super Admin Allowed? |\n| --- | --- | --- |\n| Create regular user | ‚úî | ‚úî |\n| Create admin user | ‚úî | ‚úî |\n| **Create super admin user** | ‚ùå Not Allowed | ‚úî Allowed |\n| Access full user list | ‚ùå Not Allowed | ‚úî Allowed |\n| Update/Delete users | ‚ùå Not Allowed | ‚úî Allowed |\n\nEndFragment"
					},
					"response": []
				},
				{
					"name": "get users",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/users",
							"host": [
								"{{URL}}"
							],
							"path": [
								"users"
							]
						},
						"description": "# üìò **Get All Users ‚Äî How It Works**\n\nThe **GET /users** endpoint retrieves a complete list of all users in the system.  \n  \nBecause this data is highly sensitive, access to this endpoint is **strictly restricted**.\n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### ‚úÖ **Super Admin (spadmin)**\n\nSuper Admins have full access to system-wide data.  \n  \nThey can use this endpoint to:\n\n- View all users\n    \n- Audit user accounts\n    \n- Manage roles and permissions\n    \n- Monitor system activity\n    \n\n### ‚ùå **Admin**\n\nAdmins **cannot** access this endpoint.  \n  \nThey do not have permission to view the full user list.\n\nReasons why:\n\n- It exposes all users' details (email, role, etc.)\n    \n- It gives too much visibility into system structure\n    \n- It could compromise security if misused\n    \n\n### ‚ùå **Regular Users**\n\nRegular users cannot access this endpoint under any circumstances.\n\n---\n\n# üîê **Why This Restriction Exists**\n\nViewing the full user list is considered a **privileged system operation**.  \n  \nAllowing admins to see every single user could lead to:\n\n- Unauthorized monitoring\n    \n- Accessing sensitive data\n    \n- Role misuse\n    \n- Security risks\n    \n\nTherefore, only **super admins** have the visibility required for full system oversight.\n\n---\n\n# üöÄ **How to Use This Endpoint**\n\n### 1\\. **Send a GET request to:**\n\n```\nGET /users\n\n ```\n\n### 2\\. **Attach a valid authentication token**\n\nOnly **super admins** will be authorized.\n\n### 3\\. **Response will include:**\n\n- Count of users\n    \n- List of all user profiles with basic details\n    \n- Useful for system monitoring and user management\n    \n\nExample format:\n\n```\n{\n  \"status\": \"success\",\n  \"results\": 4,\n  \"data\": [\n    {\n      \"_id\": \"68d12...\",\n      \"userName\": \"John Doe\",\n      \"email\": \"john@example.com\",\n      \"role\": \"user\"\n    }\n  ]\n}\n\n ```\n\n---\n\n# üö´ **What Admins Cannot Do**\n\n| Action | Admin Allowed? | Super Admin Allowed? |\n| --- | --- | --- |\n| Get all users | ‚ùå Not Allowed | ‚úî Allowed |\n| Get a single user | ‚ùå Not Allowed | ‚úî Allowed |\n| View sensitive user details | ‚ùå Not Allowed | ‚úî Allowed |\n\nAdmins can **create users**, but they **cannot read user data**."
					},
					"response": []
				},
				{
					"name": "Delete User",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{URL}}/users/690845e42c3142f666785b28",
							"host": [
								"{{URL}}"
							],
							"path": [
								"users",
								"690845e42c3142f666785b28"
							]
						},
						"description": "# üóëÔ∏è **Delete User ‚Äî Summary**\n\n### **Endpoint**\n\n```\nDELETE /users/:id\n\n ```\n\n### **Who Can Use This Endpoint?**\n\n- **Only Super Admin (spadmin)**  \n      \n    No other role has permission to delete a user.\n    \n\n### **Purpose**\n\nThis route permanently removes a user account from the system.  \n  \nIt is used for administrative cleanup, removing unwanted accounts, or handling misuse cases.\n\n### **Why It Is Restricted**\n\nDeleting a user is a **high-impact action** because it:\n\n- Removes access for that person\n    \n- Deletes their account data\n    \n- Cannot be undone\n    \n- Could cause security issues if misused\n    \n\nTherefore, **admins cannot delete users**, and **regular users never have access** to this route.\n\n### **How to Use**\n\nSend a DELETE request containing the user‚Äôs ID:\n\n```\nDELETE /users/68d1234ab4e59c22bc109f77\nAuthorization: Bearer <super-admin-token>\n\n ```\n\n### **Successful Outcome**\n\nYou receive a confirmation that the user was removed:\n\n```\n{\n  \"status\": \"success\",\n  \"message\": \"User deleted successfully\"\n}\n\n ```\n\n### **When It Fails**\n\n- Invalid or missing token\n    \n- The requester is not a super admin\n    \n- User ID does not exist"
					},
					"response": []
				},
				{
					"name": "get User",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/users/690845e42c3142f666785b28",
							"host": [
								"{{URL}}"
							],
							"path": [
								"users",
								"690845e42c3142f666785b28"
							]
						},
						"description": "# üë§ **Get User ‚Äî Summary**\n\n### **Endpoint**\n\n```\nGET /users/:id\n\n ```\n\n### **Who Can Use This Endpoint?**\n\n- **Only Super Admin (spadmin)**  \n      \n    No other role is allowed to retrieve another user‚Äôs full details.\n    \n\n### **Purpose**\n\nThis route is used to **view detailed information about a specific user**.  \n  \nSuper Admins use it for:\n\n- Reviewing an account\n    \n- Validating user roles\n    \n- Checking user activity or profile data\n    \n- Administrative investigations\n    \n\n### **Why It Is Restricted**\n\nAccessing an individual user's full information is sensitive because it may reveal:\n\n- Email address\n    \n- Role and permissions\n    \n- Profile details\n    \n\nAllowing admins or regular users to access this data could cause:\n\n- Privacy violations\n    \n- Unauthorized monitoring\n    \n- Security risks\n    \n\nTherefore, **only a super admin** can access this route.\n\n### **How to Use**\n\nSend a GET request with the user‚Äôs ID:\n\n```\nGET /users/68d1234ab4e59c22bc109f77\nAuthorization: Bearer <super-admin-token>\n\n ```\n\n### **Successful Outcome**\n\nYou receive the full user object:\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"user\": {\n      \"_id\": \"68d1234ab4e59c22bc109f77\",\n      \"userName\": \"John Doe\",\n      \"email\": \"john@example.com\",\n      \"role\": \"user\",\n      \"country\": \"India\",\n      \"countryCode\": \"+91\",\n      \"profile\": \"https://cloudinary.com/default.jpg\"\n    }\n  }\n}\n\n ```\n\n### **When It Fails**\n\n- Missing or invalid authentication token\n    \n- User is not a super admin\n    \n- User with the given ID does not exist\n    \n\nEndFragment"
					},
					"response": []
				},
				{
					"name": "patch User",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "userName",
									"value": "kolanupaka",
									"type": "text"
								},
								{
									"key": "profile",
									"type": "file",
									"src": "/C:/Users/kolan/OneDrive/Pictures/Screenshots/Screenshot 2025-06-12 215338.png"
								}
							]
						},
						"url": {
							"raw": "{{URL}}/users/690845e42c3142f666785b28",
							"host": [
								"{{URL}}"
							],
							"path": [
								"users",
								"690845e42c3142f666785b28"
							]
						},
						"description": "# üõ†Ô∏è **Update User ‚Äî Summary**\n\n### **Endpoint**\n\n```\nPATCH /users/:id\n\n ```\n\n### **Who Can Use This Endpoint?**\n\n- **Only Super Admin (spadmin)**  \n      \n    No other role is allowed to update user details or user profile images.\n    \n\n---\n\n### **Purpose**\n\nThis route allows a super admin to **modify user information**, including:\n\n- Basic fields (name, email, country, role, etc.)\n    \n- **Profile image** (uploaded through form-data as `profile`)\n    \n\nIt is used for administrative corrections, account management, and updating user records.\n\n---\n\n### **Why It Is Restricted**\n\nUpdating user details is sensitive because it can:\n\n- Change a user‚Äôs role\n    \n- Update personal identity information\n    \n- Replace the profile image\n    \n- Impact permissions and access levels\n    \n\nTo prevent misuse, **admins and regular users cannot update any user**.\n\nOnly super admins have the authority to perform such high-privilege operations.\n\n---\n\n### **How to Use**\n\nSend a `PATCH` request with **only the fields you want to update**.\n\n### **For updating profile image**\n\nUse **form-data** and upload a file under the key `\"profile\"`:\n\n```\nPATCH /users/690845e42c3142f666785b28\nAuthorization: Bearer <super-admin-token>\nContent-Type: multipart/form-data\n\n ```\n\n| Key | Value | Type |\n| --- | --- | --- |\n| profile | (upload image file) | File |\n\n### **For updating normal fields**\n\nUse JSON:\n\n```\n{\n  \"userName\": \"Updated Name\",\n  \"country\": \"USA\"\n}\n\n ```\n\n---\n\n### **Successful Outcome**\n\nYou receive a confirmation with the updated user object:\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"user\": {\n      \"_id\": \"690845e42c3142f666785b28\",\n      \"userName\": \"Updated Name\",\n      \"profile\": \"https://cloudinary.com/.../new-image.jpg\"\n    }\n  }\n}\n\n ```\n\n---\n\n### **When It Fails**\n\n- Missing or invalid token\n    \n- Trying to update without super admin role\n    \n- Invalid or unsupported fields\n    \n- User ID not found"
					},
					"response": []
				}
			],
			"description": "# üë§ **Users Module ‚Äì Overview**\n\nThe **Users Module** manages all user accounts within _The World Oasis_ system.\n\nAll routes in this module are **protected**, meaning authentication is required before accessing any user-related operations.\n\nThis module controls how users are created, updated, retrieved, and removed. It also applies strict role-based access rules to ensure that only authorized personnel can manage sensitive user information.\n\n### **Role-Based Access Control**\n\n- **Super Admin (spadmin)** has full control over all user operations.\n    \n    They can create new users, view all users, update user details, delete accounts, and fetch individual user information.\n    \n- **Admin** users have limited permissions.\n    \n    They are allowed to create new users, but **cannot** view the full user list, view individual user details, update users, or delete users.\n    \n- **Regular Users** (normal users) do not have access to any user management operations.\n    \n\n### **Profile Image Handling**\n\nThe module uses **Multer (memory storage)** to accept profile image uploads, which are then processed and uploaded directly to Cloudinary from memory buffers. This avoids saving temporary files on the server.\n\n### **Security Enforcement**\n\nAll incoming requests first pass through:\n\n- **Authentication middleware** ‚Äì verifies the user‚Äôs login token.\n    \n- **Authorization middleware** ‚Äì ensures the user's role matches the required permission level.\n    \n\nThis structured security approach ensures that sensitive user operations are tightly controlled and safe from unauthorized access"
		},
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Sign In",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Parse the response body as JSON",
									"let res = pm.response.json();",
									"",
									"// Check if the token exists in res.data.token",
									"if (res.data && res.data.token) {",
									"    // Store the token as an environment variable named 'token'",
									"    pm.environment.set(\"token\", res.data.token);",
									"    console.log(\"Token saved to environment variable.\");",
									"} else {",
									"    console.warn(\"Token not found in response.\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\"email\":\"spadmin@worldoasis.com\",\r\n\"password\":\"Admin2000@\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/auth/signIn",
							"host": [
								"{{URL}}"
							],
							"path": [
								"auth",
								"signIn"
							]
						},
						"description": "StartFragment\n\n# üîê **Sign In**\n\n### **Endpoint**\n\n```\nPOST /auth/signIn\n\n ```\n\n### **Who Can Use This Endpoint?**\n\n- **Anyone** can use this route.\n    \n- **No authentication token is required**, because this endpoint is used to _obtain_ a token.\n    \n\nThis is the entry point for users to log into the system.\n\n---\n\n# üéØ **Purpose**\n\nThe Sign In route verifies user credentials (email + password).  \n  \nIf the credentials are valid, the system returns:\n\n- The authenticated user‚Äôs basic information\n    \n- An authentication token (JWT or equivalent)\n    \n\nThis token is required to access all protected routes in the application.\n\n---\n\n# üõ†Ô∏è **How to Use**\n\n### **Send a POST request to:**\n\n```\nPOST /auth/signIn\n\n ```\n\n### **Request Body**\n\n```\n{\n  \"email\": \"john@example.com\",\n  \"password\": \"YourPassword123!\"\n}\n\n ```\n\n### **Expected Behavior**\n\n- If the email and password match an existing user ‚Üí login succeeds.\n    \n- If they do not match ‚Üí login fails with an error.\n    \n\n---\n\n# üì§ **Successful Outcome**\n\nYou receive:\n\n1. A login success message\n    \n2. The user object\n    \n3. A token to be used for future requests\n    \n\nExample:\n\n```\n{\n  \"status\": \"success\",\n  \"token\": \"<your-auth-token>\",\n  \"data\": {\n    \"user\": {\n      \"_id\": \"68d...\",\n      \"userName\": \"John Doe\",\n      \"email\": \"john@example.com\",\n      \"role\": \"user\",\n      \"country\": \"India\",\n      \"profile\": \"https://cloudinary.com/.../default.jpg\"\n    }\n  }\n}\n\n ```\n\n---\n\n# ‚ùó When It Fails\n\n- Invalid email\n    \n- Wrong password\n    \n- Account inactive\n    \n- Required fields missing\n    \n\nExample error:\n\n```\n{\n  \"status\": \"fail\",\n  \"message\": \"Invalid email or password\"\n}\n\n ```\n\nEndFragment"
					},
					"response": []
				},
				{
					"name": "Sign Up",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Parse the response body as JSON\r",
									"let res = pm.response.json();\r",
									"\r",
									"// Check if the token exists in res.data.token\r",
									"if (res.data && res.data.token) {\r",
									"    // Store the token as an environment variable named 'token'\r",
									"    pm.environment.set(\"token\", res.data.token);\r",
									"    console.log(\"Token saved to environment variable.\");\r",
									"} else {\r",
									"    console.warn(\"Token not found in response.\");\r",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "  {\r\n    \"userName\": \"spadmin\",\r\n    \"email\": \"spadmin@worldoasis.com\",\r\n    \"password\": \"Admin2000@\",\r\n    \"country\": \"India\",\r\n    \"countryCode\": \"IN\",\r\n    \"profile\": \"https://randomuser.me/api/portraits/men/2.jpg\",\r\n    \"role\":\"spadmin\"\r\n  }",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/auth/signUp",
							"host": [
								"{{URL}}"
							],
							"path": [
								"auth",
								"signUp"
							]
						},
						"description": "# üìù **Sign Up**\n\n### **Endpoint**\n\n```\nPOST /auth/signUp\n\n ```\n\n### **Who Can Use This Endpoint?**\n\n- Anyone can register using this route.\n    \n- No authentication token is required.\n    \n\n---\n\n# üéØ **Purpose**\n\nThis route allows a new user to create an account.  \n  \nAll required fields are validated, the password is securely encrypted, and the account is created with safe defaults.\n\n---\n\n# üì• **Required Fields**\n\nThe request body must include:\n\n| Field | Type | Description |\n| --- | --- | --- |\n| **userName** | String | Unique username for the account |\n| **email** | String | Valid email address |\n| **password** | String | Must follow password rules (complexity required) |\n| **country** | String | User‚Äôs country |\n| **countryCode** | String | User‚Äôs country code |\n\n---\n\n# üîê **Role Behavior**\n\n### **The role is always set to** **`\"user\"`** **automatically.**\n\nAny value provided by the client (like `\"admin\"` or `\"spadmin\"`) is **ignored**.\n\nThis ensures:\n\n- No one can create privilege-escalated accounts through sign-up\n    \n- Security and access control remain consistent\n    \n- Elevated roles can only be assigned by Super Admins through authorized routes\n    \n\n---\n\n# üñºÔ∏è **Profile Behavior**\n\n- No profile field is required.\n    \n- A **default profile image** is assigned automatically.\n    \n\n---\n\n# üì§ **Expected Outcome**\n\n- The system validates all input.\n    \n- The password is encrypted.\n    \n- The new user account is created with:\n    \n    - `role = \"user\"` (forced)\n        \n    - Default profile image\n        \n    - Active status\n        \n\nA success response is returned, usually with a token and the created user object."
					},
					"response": []
				},
				{
					"name": "sign Out",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{URL}}/auth/signOut",
							"host": [
								"{{URL}}"
							],
							"path": [
								"auth",
								"signOut"
							]
						},
						"description": "# üîê **Sign Out ‚Äî Summary**\n\n### **Endpoint**\n\n```\nPOST /auth/signOut\n\n ```\n\n### **Who Can Use This Endpoint?**\n\n- Any **authenticated user**.\n    \n- A valid token is required because the system needs to identify **which session** to sign out from.\n    \n\n---\n\n# üéØ **Purpose**\n\nThis route logs the user out **only from the current device/session** they are using.\n\nIt does **not** log out the user from other devices or sessions.\n\nThis ensures:\n\n- Users can sign out safely from one device\n    \n- Ongoing sessions on other devices remain active\n    \n- Security is maintained for multi-device usage\n    \n\n---\n\n# üõ†Ô∏è **How It Works**\n\nWhen the user sends a sign-out request with a valid token:\n\n- The system identifies the session linked to that token\n    \n- That specific session is **invalidated / removed / deactivated**\n    \n- All other active sessions for the same user remain untouched\n    \n\nThis is ideal for:\n\n- Mobile + Web multi-login\n    \n- Controlled session management\n    \n- Logging out stolen or compromised session\n    \n\n---\n\n# üì• **Request Requirements**\n\n- Must include a valid **authentication token** in the request header:\n    \n\n```\nAuthorization: Bearer <token>\n\n ```\n\nThere is **no request body** required for sign-out.\n\n---\n\n# üì§ **Expected Outcome**\n\nA simple confirmation message:\n\n```\n{\n  \"status\": \"success\",\n  \"message\": \"Signed out successfully from this device.\"\n}\n\n ```\n\n---\n\n# ‚ùó When It Fails\n\n- Missing token ‚Üí user is not authenticated\n    \n- Invalid/expired token ‚Üí session can‚Äôt be found\n    \n- Session already revoked\n    \n\nError example:\n\n```\n{\n  \"status\": \"fail\",\n  \"message\": \"Invalid or expired session.\"\n}\n\n ```"
					},
					"response": []
				}
			]
		},
		{
			"name": "Account",
			"item": [
				{
					"name": "update Account",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "multipart/form-data",
								"type": "text"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "userName",
									"value": "spadmin",
									"type": "text"
								},
								{
									"key": "profile",
									"type": "file",
									"src": "/C:/Users/kolan/OneDrive/Pictures/Screenshots/Screenshot 2024-11-07 115018.png"
								}
							]
						},
						"url": {
							"raw": "{{URL}}/account",
							"host": [
								"{{URL}}"
							],
							"path": [
								"account"
							]
						},
						"description": "# üõ†Ô∏è **Update My Account**\n\n### **Endpoint**\n\n```\nPATCH /account\n\n ```\n\n---\n\n# üë§ **Purpose**\n\nThis route allows an authenticated user to **update their own general account details**, including their **profile image**.  \n  \nIt is strictly for **self-updates only**, meaning users can only modify their own account and not anyone else‚Äôs.\n\nThis endpoint **does NOT handle password changes**.  \n  \nPassword updates are handled by a separate route.\n\n---\n\n# üß© **What You Can Update**\n\nUsers can modify the following fields:\n\n| Field | Description |\n| --- | --- |\n| **userName** | Update your display username |\n| **email** | Update your email address |\n| **country** | Update your country |\n| **countryCode** | Update your country code |\n| **profile** | Update your profile image (via file upload) |\n\n### **Profile Image Upload**\n\nTo update the profile image, use:\n\n```\nContent-Type: multipart/form-data\n\n ```\n\nwith a file under the key:\n\n```\nprofile\n\n ```\n\n---\n\n# üîê **Who Can Access This Route?**\n\n- **Any authenticated user** (regular user, admin, super admin)\n    \n- Applies **only to their own account**\n    \n- No one can update someone else‚Äôs account through this route\n    \n\n---\n\n# üö´ **What This Route Cannot Do**\n\n- Cannot update **password**\n    \n- Cannot update **role**\n    \n- Cannot update **status**\n    \n- Cannot update **other users**\n    \n- Cannot modify system-level fields\n    \n\nThese actions belong to other endpoints (`/users`, `/account/updatePassword`, etc.).\n\n---\n\n# üß≠ **How to Use**\n\n### **Option 1 ‚Äî Update text fields**\n\n```\nPATCH /account\nAuthorization: Bearer <token>\nContent-Type: application/json\n\n ```\n\nBody:\n\n```\n{\n  \"userName\": \"NewName\",\n  \"email\": \"new@example.com\",\n  \"country\": \"USA\",\n  \"countryCode\": \"+1\"\n}\n\n ```\n\n### **Option 2 ‚Äî Update profile image**\n\n```\nPATCH /account\nAuthorization: Bearer <token>\nContent-Type: multipart/form-data\n\n ```\n\nForm-data:\n\n- `profile` ‚Üí (upload image file)\n    \n\n---\n\n# üì§ **Expected Outcome**\n\n- User information is updated\n    \n- Profile image is replaced if provided\n    \n- Response includes updated user details\n    \n\n---\n\n# ‚ùó **When It Fails**\n\n- Missing/invalid authentication\n    \n- Email or username already in use\n    \n- Invalid data\n    \n- Uploaded file not supported\n    \n- Attempt to update restricted fields"
					},
					"response": []
				},
				{
					"name": "update Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Parse the response body as JSON\r",
									"let res = pm.response.json();\r",
									"\r",
									"// Check if the token exists in res.data.token\r",
									"if (res.data && res.data.token) {\r",
									"    // Store the token as an environment variable named 'token'\r",
									"    pm.environment.set(\"token\", res.data.token);\r",
									"    console.log(\"Token saved to environment variable.\");\r",
									"} else {\r",
									"    console.warn(\"Token not found in response.\");\r",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\r\n   \"oldPassword\": \"Password45@\", \r\n   \"newPassword\" : \"Spadmin89@\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/account/update-password",
							"host": [
								"{{URL}}"
							],
							"path": [
								"account",
								"update-password"
							]
						},
						"description": "# üîê **Sign Out From All Devices**\n\n### **Endpoint**\n\n```\nPOST /auth/signOut-all\n\n ```\n\n---\n\n# üéØ **Purpose**\n\nThis route logs the user out from **every active session across all devices**, ensuring that all previously issued tokens are invalidated.\n\nAfter clearing all sessions, the system immediately generates and returns **a new token for the current active request**, so the user stays logged in on the device that triggered the action.\n\nThis is extremely useful for:\n\n- Securing the account after password changes\n    \n- Cutting off unauthorized access\n    \n- Resetting all sessions while keeping the current device active\n    \n\n---\n\n# üîê **Who Can Use This Endpoint?**\n\n- **Any authenticated user** can trigger a full session reset.\n    \n- Applies equally to regular users, admins, and super admins.\n    \n\n---\n\n# üõ†Ô∏è **How It Works**\n\n1. The system identifies the user from the provided token.\n    \n2. It clears **all existing sessions/tokens** for that user.\n    \n3. It immediately creates **a brand new session**.\n    \n4. A fresh authentication token is returned in the response.\n    \n\nAll other devices, browsers, and sessions are logged out.\n\n---\n\n# üì• **Request Requirements**\n\n```\nAuthorization: Bearer <current-token>\n\n ```\n\nNo request body is required.\n\n---\n\n# üì§ **Expected Outcome**\n\nA confirmation message along with a **newly issued token**:\n\n```\n{\n  \"status\": \"success\",\n  \"message\": \"Signed out from all devices. A new session has been created.\",\n  \"token\": \"<newly-issued-token>\"\n}\n\n ```\n\n---\n\n# ‚ùó When It Fails\n\n- Missing or invalid token\n    \n- Session not found\n    \n- User not authenticated\n    \n- Internal session clearing issues\n    \n\nFailure example:\n\n```\n{\n  \"status\": \"fail\",\n  \"message\": \"Unable to reset sessions.\"\n}\n\n ```"
					},
					"response": []
				}
			],
			"description": "# üßæ **Account Module**\n\nThe **Account Module** is designed specifically for **self-service account management**.  \n  \nIt allows an authenticated user to update **their own profile information** and **change their password** without involving admins or super admins.\n\nThis module does **not** allow users to modify other users‚Äô data.\n\n---\n\n## üë§ **What This Module Is For**\n\nThe account module handles:\n\n### **1\\. Updating your own account details**\n\nThis may include changes to:\n\n- userName\n    \n- country\n    \n- countryCode\n    \n- profile image\n    \n- other personal fields that are safe for self-updates\n    \n\n### **2\\. Updating your own password**\n\nA secure, dedicated route for:\n\n- entering current password\n    \n- validating it\n    \n- setting a new password\n    \n\nBoth operations follow strict security rules to protect user identity and login access.\n\n---\n\n## üîê **Who Can Use Account Routes?**\n\n- **Any authenticated user**  \n      \n    Each user can update only **their own data**.\n    \n- **Admins and super admins are treated like normal users here**  \n      \n    Even a super admin can only update **their own account** from this module.  \n      \n    They cannot modify someone else‚Äôs account via these routes.\n    \n\n---\n\n## üö´ **What This Module Is NOT For**\n\n- Viewing another user‚Äôs profile\n    \n- Updating another user‚Äôs details\n    \n- Changing another user‚Äôs password\n    \n- Admin-level user management\n    \n\nThese actions belong to the **Users Module**, not the Account Module.\n\n---\n\n## üõ°Ô∏è **Why a Separate Account Module?**\n\nSeparating account-related operations provides:\n\n- **Better security**  \n      \n    Password updates require dedicated validation and protection.\n    \n- **Cleaner architecture**  \n      \n    User management (admin side) stays in `/users`,  \n      \n    personal account management stays in `/account`.\n    \n- **Clear boundaries**  \n      \n    Self-service changes vs. privileged changes are not mixed."
		},
		{
			"name": "Settings",
			"item": [
				{
					"name": "get settings",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/settings",
							"host": [
								"{{URL}}"
							],
							"path": [
								"settings"
							]
						},
						"description": "# üìò **GET /settings**\n\n### **Endpoint**\n\n```\nGET /settings\n\n ```\n\n### **Purpose**\n\nReturns the current global configuration values used across the platform.  \n  \nThese values determine minimum booking nights, maximum nights, breakfast pricing, and other operational rules.\n\n### **Who Can Access**\n\n- **Super Admin (spadmin)** ‚Äî ‚úî Allowed\n    \n- **Admin** ‚Äî ‚úî Allowed\n    \n- **Regular User** ‚Äî ‚ùå Not Allowed\n    \n\n### **What It Returns**\n\nA single settings object containing:\n\n- `minNights`\n    \n- `maxNights`\n    \n- `breakfastPrice`\n    \n\n### **Usage**\n\nThis endpoint is typically used by:\n\n- Admins adjusting pricing or booking rules\n    \n- Dashboard apps displaying system settings\n    \n- Booking logic verifying allowed nights\n    \n\n### **Response Example**\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"settings\": {\n      \"minNights\": 1,\n      \"maxNights\": 7,\n      \"breakfastPrice\": 120\n    }\n  }\n}\n\n ```"
					},
					"response": []
				},
				{
					"name": "update settings",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\r\n    \"minNights\": 3\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/settings",
							"host": [
								"{{URL}}"
							],
							"path": [
								"settings"
							]
						},
						"description": "# üõ†Ô∏è **PATCH /settings**\n\n### **Endpoint**\n\n```\nPATCH /settings\n\n ```\n\n### **Purpose**\n\nAllows privileged users to update global system settings.  \n  \nOnly fields present in the request body will be updated.\n\n### **Updatable Fields**\n\n| Field | Type | Description |\n| --- | --- | --- |\n| **minNights** | Number | Minimum nights allowed per booking |\n| **maxNights** | Number | Maximum nights allowed per booking |\n| **breakfastPrice** | Number | Price added for breakfast |\n\nMore settings may be added in future versions.\n\n---\n\n### **Who Can Update**\n\n- **Super Admin (spadmin)** ‚Äî ‚úî Full Access\n    \n- **Admin** ‚Äî ‚úî Allowed (with limited scope depending on your permissions logic)\n    \n- **Regular User** ‚Äî ‚ùå Not Allowed\n    \n\nThis route is considered **high-impact**, as it affects all bookings and pricing logic across the system.\n\n---\n\n### **How to Use**\n\n```\nPATCH /settings\nAuthorization: Bearer <token>\nContent-Type: application/json\n\n ```\n\nBody (example of partial update):\n\n```\n{\n  \"maxNights\": 10,\n  \"breakfastPrice\": 150\n}\n\n ```\n\n---\n\n### **Expected Outcome**\n\n- Only provided fields are updated\n    \n- System returns the updated settings object\n    \n\n### **Response Example**\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"settings\": {\n      \"minNights\": 1,\n      \"maxNights\": 10,\n      \"breakfastPrice\": 150\n    }\n  }\n}\n\n ```\n\n---\n\n# ‚ö†Ô∏è **When It Fails**\n\n- Unauthorized user tries to update settings\n    \n- Invalid values (e.g., negative numbers)\n    \n- Missing authentication token\n    \n- Attempt to update fields not allowed"
					},
					"response": []
				}
			],
			"description": "# ‚öôÔ∏è **Settings Model**\n\nThe **Settings Model** represents a small but central part of the system configuration.  \n  \nIt defines global operational rules that influence how reservations, pricing, and user interactions behave across _The World Oasis_ platform.\n\nThis model is still **in the development phase**, and more fields/features are expected to be added in future versions.\n\n---\n\n# üß© **Current Fields**\n\nBelow are the fields currently included in the settings structure:\n\n---\n\n## üõèÔ∏è **minNights**\n\n- **Type:** Number\n    \n- **Default:** `1`\n    \n- **Description:**  \n      \n    Determines the **minimum number of nights** a user must book when making a reservation.  \n      \n    This prevents users from booking for less than the allowed minimum stay.\n    \n\n---\n\n## üè® **maxNights**\n\n- **Type:** Number\n    \n- **Default:** `1`\n    \n- **Description:**  \n      \n    Specifies the **maximum number of nights** allowed per booking.  \n      \n    This helps control long-term stays and ensures availability for other guests.\n    \n\n---\n\n## üç≥ **breakfastPrice**\n\n- **Type:** Number\n    \n- **Default:** `0`\n    \n- **Description:**  \n      \n    Defines the **additional cost** of including breakfast with a booking.  \n      \n    This fee is applied per guest or per night, depending on your booking logic.\n    \n\n---\n\n# üöß **Development Status**\n\nThis module is currently in **active development**, and future versions may include:\n\n- Seasonal pricing\n    \n- Taxes and fees\n    \n- Service charges\n    \n- Cancellation policies\n    \n- Discounts\n    \n- Booking rules\n    \n- Dynamic configuration options\n    \n- Feature toggles\n    \n\nAdmins and Super Admins will gain more control through these upcoming settings features.\n\n---\n\n# üîê **Who Can Modify Settings?**\n\n- **Super Admin (spadmin):** Full access\n    \n- **Admin:** Limited access (depending on your permissions design)\n    \n- **Regular User:** No access\n    \n\nSettings updates must be handled with care because they directly affect **system-wide behavior**."
		},
		{
			"name": "Bookings",
			"item": [
				{
					"name": "get Bookings",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/bookings",
							"host": [
								"{{URL}}"
							],
							"path": [
								"bookings"
							]
						},
						"description": "# üìò **GET /bookings ‚Äî Summary**\n\n### **Endpoint**\n\n```\nGET /bookings\n\n ```\n\n### **Purpose**\n\nThis route is used to **retrieve a list of bookings**, with optional filters, sorting, and pagination.  \n  \nIt is a **data-heavy administrative endpoint** designed for dashboard views and backend management.\n\n---\n\n# üë• **Who Can Use This Endpoint**\n\n### ‚úÖ **Super Admin (spadmin)**\n\nFull access to all bookings, with full filtering and searching capabilities.\n\n### ‚ö†Ô∏è **Admin**\n\nAdmins can also access all bookings.\n\n### ‚ùå **Regular User**\n\nRegular users **cannot** use this route.  \n  \nThey must use `/my-bookings` instead to see **their own** bookings only.\n\n---\n\n# üß© **Query Parameters Available**\n\nThe endpoint supports powerful filtering, sorting, field selection, and pagination.\n\n---\n\n## 1Ô∏è‚É£ **Filter by Status (****`phase`****)**\n\nUse the `phase` query parameter to filter bookings by their lifecycle status.\n\n| Value | Meaning |\n| --- | --- |\n| `all` | Retrieves all bookings |\n| `checked-out` | Only bookings that have been checked out |\n| `checked-in` | Only bookings that are currently checked in |\n| `unconfirmed` | Newly created or pending bookings |\n\n### Example:\n\n```\nGET /bookings?phase=checked-in\n\n ```\n\n---\n\n## 2Ô∏è‚É£ **Sorting (****`sortBy`****)**\n\nAllows sorting results by date or sales total.\n\n| Value | Sort Field | Order |\n| --- | --- | --- |\n| `startDate-desc` | startDate | newest first |\n| `startDate-asc` | startDate | oldest first |\n| `totalPrice-desc` | totalSales | highest first |\n| `totalPrice-asc` | totalSales | lowest first |\n\n### Example:\n\n```\nGET /bookings?sortBy=totalPrice-desc\n\n ```\n\n---\n\n## 3Ô∏è‚É£ **Pagination (****`page`****,** **`limit`****)**\n\n- `page` ‚Üí Which page of results to retrieve\n    \n- `limit` ‚Üí How many results per page\n    \n\n(Default: `page = 1`, `limit = 10`)\n\n### Example:\n\n```\nGET /bookings?page=2&limit=20\n\n ```\n\n---\n\n## 4Ô∏è‚É£ **Field Selection (****`fields`****)**\n\nAllows selecting **specific fields** from the booking, user, or cabin.\n\nUseful for dashboard optimization.\n\n### Example:\n\n```\nGET /bookings?fields=userId,cabinId,startDate,totalSales\n\n ```\n\n---\n\n## 5Ô∏è‚É£ **Custom Filters**\n\nAny additional query parameters are interpreted as filters.  \n  \nAdmins/spadmins can filter by:\n\n- date ranges\n    \n- userId\n    \n- cabinId\n    \n- payment status\n    \n- custom values\n    \n\n### Example:\n\n```\nGET /bookings?userId=68cbb2936c7dae7b9b062399\n\n ```\n\n---\n\n# üè∑Ô∏è **Populated Fields**\n\nEach booking may return populated references for:\n\n- **userId** ‚Üí basic user information\n    \n- **cabinId** ‚Üí basic cabin information\n    \n\nThis makes the response ready for dashboards without requiring extra API calls.\n\n---\n\n# üí° **Key Things to Remember**\n\n1. **Only admins and super admins** can use this route.\n    \n2. Regular users must use `/my-bookings` instead.\n    \n3. You can filter by booking status using `phase`.\n    \n4. You can sort results using `sortBy`.\n    \n5. Pagination is available via `page` and `limit`.\n    \n6. Use `fields` to return _only the columns you need_.\n    \n7. You can combine all features for advanced searching.\n    \n\n---\n\n# üß≠ **Example Combined Query**\n\n```\nGET /bookings?phase=checked-in&sortBy=startDate-desc&page=1&limit=10&fields=userId,cabinId,totalSales\n\n ```\n\nThis retrieves:\n\n- Only checked-in bookings\n    \n- Newest first\n    \n- First 10 results\n    \n- Including only selected fields\n    \n- With user and cabin populated"
					},
					"response": []
				},
				{
					"name": "get Booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/bookings/6904f9b6ed98751c87ee0033?fields=-userId,-cabinId.created_at,-cabinId.capacity,-status",
							"host": [
								"{{URL}}"
							],
							"path": [
								"bookings",
								"6904f9b6ed98751c87ee0033"
							],
							"query": [
								{
									"key": "fields",
									"value": "-userId,-cabinId.created_at,-cabinId.capacity,-status"
								}
							]
						},
						"description": "# üìò **GET /bookings/:id**\n\n### **Endpoint**\n\n```\nGET /bookings/:id\n\n ```\n\n### **Purpose**\n\nRetrieve the **full details** of a specific booking.  \n  \nThis route supports both:\n\n- **Admin/Super Admin access** ‚Üí Can view _any_ booking\n    \n- **User access (self-service)** ‚Üí Can view _only their own_ booking using the `/my-bookings/:id` context\n    \n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### üîπ **Super Admin (spadmin)**\n\nFull access ‚Äî can retrieve any booking by ID.\n\n### üîπ **Admin**\n\nFull access ‚Äî can retrieve any booking by ID.\n\n### üîπ **Regular User**\n\n**Restricted access** ‚Äî users can only fetch their own booking details.  \n  \nThis is enforced automatically when the route is accessed through a **\"me\"** context (e.g., `/my-bookings/:id`).\n\nUsers **cannot** view someone else‚Äôs booking.\n\n---\n\n# üß© **Field Selection (****`fields`** **query)**\n\nAdmins and super admins can customize which fields they want returned using the `fields` query parameter.\n\nExample:\n\n```\nGET /bookings/6904f9b6ed98751c87ee0033?fields=userId,cabinId,startDate,totalSales\n\n ```\n\nThis is useful for dashboards or partial previews.\n\n### For regular users (\"me\" context):\n\n- Sensitive fields (like other user details) are automatically removed\n    \n- Cabin metadata and internal fields are limited\n    \n- User cannot control the fields returned\n    \n- Only safe data is returned\n    \n\n---\n\n# üß≠ **How to Use**\n\n### Fetch a booking by ID:\n\n```\nGET /bookings/6904f9b6ed98751c87ee0033\nAuthorization: Bearer <token>\n\n ```\n\nAdmins/spadmins receive full details, populated with:\n\n- User details (userId)\n    \n- Cabin details (cabinId)\n    \n\nUsers receive only their own booking with:\n\n- Certain fields hidden (userId, cabin capacity, cabin creation date, status etc.)\n    \n\n---\n\n# üîó **Populated Data**\n\nThe response may include populated references for:\n\n- **userId** ‚Üí Basic user info\n    \n- **cabinId** ‚Üí Cabin details relevant to the booking\n    \n\nThis helps dashboards and management panels avoid multiple round trips.\n\n---\n\n# üí° **Key Things to Remember**\n\n1. **Admins and Super Admins** can view **any** booking.\n    \n2. **Users can view only their own bookings** (automatic enforcement).\n    \n3. Field selection using `fields` is available to admin roles only.\n    \n4. In user context (\"me\"), the API automatically hides sensitive fields.\n    \n5. Populated fields (user and cabin info) are included depending on role and selected fields."
					},
					"response": []
				},
				{
					"name": "delete Booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{URL}}/bookings/69045ca9835d92574095e1ce",
							"host": [
								"{{URL}}"
							],
							"path": [
								"bookings",
								"69045ca9835d92574095e1ce"
							]
						},
						"description": "# üßæ **Delete Booking**\n\n### **Endpoint**\n\n```\nDELETE /bookings/:id\n\n ```\n\n### **Example**\n\n```\nDELETE /bookings/69045ca9835d92574095e1ce\nAuthorization: Bearer <token>\n\n ```\n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### ‚úÖ **Super Admin (spadmin)**\n\nFull permission to delete any booking.\n\n### ‚úÖ **Admin**\n\nAllowed to delete any booking.\n\n### ‚ùå **Regular User**\n\nUsers cannot delete bookings using this route.  \n  \nThey must use the **‚Äúme‚Äù context‚Äù** route if you provide a user-side delete (e.g. `/my-bookings/:id`).  \n  \nRegular users can only delete bookings **they created**, not someone else's.\n\n---\n\n# üéØ **Purpose**\n\nThis route is used to:\n\n- Remove incorrect bookings\n    \n- Stay cancellations (admin-side)\n    \n- Fix duplicate or invalid reservations\n    \n- Clean up system data\n    \n\nThe deletion is **permanent**.\n\n---\n\n# üí° **Context Behavior (‚Äúme‚Äù vs admin)**\n\nYour controller supports two behaviors:\n\n### **1Ô∏è‚É£ Admin/Super Admin**\n\n- Request goes through `DELETE /bookings/:id`\n    \n- Can delete **any booking**\n    \n- Uses the ID from the URL\n    \n\n### **2Ô∏è‚É£ ‚ÄúMe‚Äù Context (User-side)**\n\nIf the API is called from a route like `DELETE /my-bookings/:bookingId`:\n\n- User can only delete **their own booking**\n    \n- If user tries to delete someone else‚Äôs booking ‚Üí it returns **404 Not Found**  \n      \n    (so users cannot even detect others‚Äô booking IDs)\n    \n\nYour controller already prevents privilege violations automatically.\n\n---\n\n# üì§ **Success Response**\n\n### **Status Code:** `204 No Content`\n\nMeaning:\n\n- The booking was successfully deleted\n    \n- There is **no response body**\n    \n\nYour API returns:\n\n```\n{\n  \"status\": \"success\",\n  \"data\": null\n}\n\n ```\n\n---\n\n# ‚ùó When It Fails\n\n### üî∏ Booking Not Found (404)\n\nReturned when:\n\n- The ID does not exist\n    \n- The booking was already deleted\n    \n- A user attempts to delete a booking that doesn't belong to them\n    \n\nResponse:\n\n```\n{\n  \"status\": \"fail\",\n  \"message\": \"Booking not found!!\"\n}\n\n ```\n\n### üî∏ Unauthorized (401)\n\nMissing or invalid token.\n\n### üî∏ Forbidden (403)\n\nIf a regular user tries to delete a booking through admin routes.\n\n---\n\n# üß† **Important Things to Remember**\n\n- **Admins and Super Admins** can delete **any** booking.\n    \n- **Users can only delete their own booking** (when using a ‚Äúme‚Äù context route).\n    \n- Invalid IDs always return a clean **404 Not Found**.\n    \n- Response status is **204**, meaning successful permanent deletion.\n    \n- Deletion impacts records permanently ‚Äî no soft delete in this module."
					},
					"response": []
				},
				{
					"name": "create Booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userId\": \"{{userId}}\",\r\n  \"cabinId\": \"{{cabinId}}\",\r\n  \"startDate\": \"{{startDate}}\",\r\n  \"endDate\": \"{{endDate}}\",\r\n  \"noOfUsers\": \"{{noOfUsers}}\",\r\n  \"observation\": \"{{observation}}\",\r\n  \"breakFast\": \"{{breakFast}}\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/bookings",
							"host": [
								"{{URL}}"
							],
							"path": [
								"bookings"
							]
						},
						"description": "# üè® **POST /bookings**\n\n### **Endpoint**\n\n```\nPOST /bookings\n\n ```\n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### ‚úÖ **Super Admin (spadmin)** ‚Äî Allowed\n\n### ‚ùå **Admin** ‚Äî Not allowed\n\n### ‚ùå **Regular User** ‚Äî Not allowed\n\nThis route is strictly for **backend/admin panel usage**, where a Super Admin creates bookings **on behalf of users** (walk-ins, call center bookings, manual entries, corrections, etc.).\n\n---\n\n# üéØ **Purpose**\n\nThis endpoint allows the Super Admin to manually create a booking for any customer.  \n  \nIt is useful for:\n\n- Manual reservations\n    \n- Customer support bookings\n    \n- Fixing bookings\n    \n- Creating bookings via admin dashboards\n    \n\nThis route is **not** for users booking cabins themselves.\n\n---\n\n# üì• **Required Request Body**\n\n| Field | Type | Required | Description |\n| --- | --- | --- | --- |\n| **userId** | ObjectId | Yes | The customer for whom the booking is being created |\n| **cabinId** | ObjectId | Yes | The cabin being assigned |\n| **startDate** | Date | Yes | Check-in date |\n| **endDate** | Date | Yes | Check-out date |\n| **noOfUsers** | Number | Yes | Number of guests |\n| **breakFast** | Boolean | No | Add breakfast (extra charge) |\n| **observation** | String | No | Staff notes or special requests |\n\n> \n\n**Important:**  \n  \nPrices (`sales`, `extraSales`, `totalSales`) are **NOT sent by client** ‚Äî they are calculated automatically.\n\n \n  \n\n---\n\n# üß† **Important Booking Rules (Automatically Enforced)**\n\nThe system automatically validates the following before saving:\n\n### ‚úî Cabin must exist\n\n### ‚úî User must exist and must be active\n\n### ‚úî User role must be `\"user\"` (employees cannot be booked)\n\n### ‚úî No date conflicts (no overlapping bookings)\n\n### ‚úî noOfUsers must not exceed cabin capacity\n\n### ‚úî The length of stay must follow Settings:\n\n- `minNights`\n    \n- `maxNights`\n    \n\n### ‚úî Pricing is auto-calculated\n\n- Base price minus discount\n    \n- Breakfast charges (if enabled)\n    \n- Total sales amount\n    \n\n---\n\n# üì§ **Successful Response (201 Created)**\n\nThe system returns the booking with:\n\n- Selected user fields (protected, no admin fields)\n    \n- Selected cabin fields\n    \n- All calculated price fields\n    \n\nExample structure:\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"_id\": \"...\",\n    \"userId\": { ... },\n    \"cabinId\": { ... },\n    \"startDate\": \"...\",\n    \"endDate\": \"...\",\n    \"noOfUsers\": 3,\n    \"sales\": 3000,\n    \"extraSales\": 300,\n    \"totalSales\": 3300\n  }\n}\n\n ```\n\n---\n\n# ‚ùó When It Fails\n\n- User does not exist\n    \n- Cabin does not exist\n    \n- User is inactive\n    \n- User is not a customer\n    \n- Booking overlaps an existing booking\n    \n- Guest count exceeds capacity\n    \n- Stay violates min/max nights\n    \n- Missing or invalid token\n    \n- Admin (not spadmin) tries to access this route"
					},
					"response": []
				},
				{
					"name": "update Booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\r\n    \"endDate\":\"2025-10-03\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/bookings/6905eba77480b3a2a7e00eda",
							"host": [
								"{{URL}}"
							],
							"path": [
								"bookings",
								"6905eba77480b3a2a7e00eda"
							]
						},
						"description": "# üõ†Ô∏è **PATCH /bookings/:bookingID**\n\n### **Endpoint**\n\n```\nPATCH /bookings/:bookingID\n\n ```\n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### ‚úÖ **Super Admin (spadmin)**\n\nFull access to update any booking.\n\n### ‚ùå **Admin**\n\nNot allowed.\n\n### ‚ùå **Regular User**\n\nNot allowed (their self-booking update is handled separately in the ‚Äúme‚Äù context route).\n\nThis is strictly an **admin-panel update endpoint**, reserved for super admins only.\n\n---\n\n# üéØ **Purpose**\n\nThis route allows the Super Admin to update specific editable fields of an existing booking.\n\nIt is used for:\n\n- Adjusting booking dates\n    \n- Updating guest count\n    \n- Changing breakfast selection\n    \n- Adding or modifying staff notes\n    \n- Fixing incorrect booking information\n    \n\nThe update is **restricted to specific safe fields**.\n\n---\n\n# üß© **Fields That Can Be Updated**\n\nOnly the following booking fields may be modified:\n\n| Field | Description |\n| --- | --- |\n| **userId** | Assign booking to another customer |\n| **cabinId** | Change cabin |\n| **startDate** | Update check-in date |\n| **endDate** | Update check-out date |\n| **noOfUsers** | Adjust number of guests |\n| **observation** | Modify internal notes |\n| **breakFast** | Enable/disable breakfast |\n\n> \n\n**Note:**  \n  \nPrice fields (sales, totalSales, extraSales) are recalculated automatically by the model.\n\n \n  \n\n---\n\n# üîí **Business Restrictions**\n\n### ‚ùó Cannot update a **paid** booking\n\nIf the booking is already completed, updating is forbidden.\n\nThe system returns an error:\n\n```\nBooking already completed\n\n ```\n\n### ‚ùó Only the allowed fields can be patched\n\nAny other fields in the body are ignored.\n\n### ‚ùó Booking must exist\n\nIf the provided ID is invalid or not found, the API returns 404.\n\n---\n\n# üß≠ **How to Use**\n\n```\nPATCH /bookings/69045ca9835d92574095e1ce\nAuthorization: Bearer <super-admin-token>\nContent-Type: application/json\n\n ```\n\n### Example body:\n\n```\n{\n  \"startDate\": \"2025-02-01\",\n  \"endDate\": \"2025-02-05\",\n  \"noOfUsers\": 4,\n  \"breakFast\": true\n}\n\n ```\n\n---\n\n# üì§ **Successful Response (201)**\n\nReturns the updated booking (with user and cabin populated):\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"_id\": \"...\",\n    \"startDate\": \"...\",\n    \"endDate\": \"...\",\n    \"noOfUsers\": 4,\n    \"breakFast\": true,\n    \"userId\": { ... },\n    \"cabinId\": { ... }\n  }\n}\n\n ```\n\n---\n\n# ‚ùó When It Fails\n\n| Scenario | Response |\n| --- | --- |\n| Booking not found | 404 |\n| Booking already paid | 403 |\n| Unauthorized role | 403 |\n| Missing auth token | 401 |\n| Invalid data | 400 |\n\n---\n\n# üß† **Important Things to Remember**\n\n- Only **Super Admin** can update bookings from the admin panel.\n    \n- Cannot update a **paid** (completed) booking.\n    \n- Only **specific fields** can be patched.\n    \n- User and cabin details are returned with populated data.\n    \n- Price and totals are recalculated during the save."
					},
					"response": []
				},
				{
					"name": "check-in",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{URL}}/bookings/check-in/{{id}}",
							"host": [
								"{{URL}}"
							],
							"path": [
								"bookings",
								"check-in",
								"{{id}}"
							]
						},
						"description": "# üü¢ **POST /bookings/check-in/:id**\n\n### **Endpoint**\n\n```\nPOST /bookings/check-in/:id\n\n ```\n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### ‚úÖ **Admin**\n\nAllowed\n\n### ‚úÖ **Super Admin (spadmin)**\n\nAllowed\n\n### ‚ùå **Regular User**\n\nNot allowed\n\nThis route is strictly an **operational action**, used by staff during guest arrival.\n\n---\n\n# üéØ **Purpose**\n\nThis endpoint is used to **mark a booking as checked-in**, indicating that the guest has arrived at the property.\n\nThe check-in operation also **marks the booking as paid**, completing the pre-stay financial confirmation.\n\nThis is typically used by reception, property staff, or admin tools.\n\n---\n\n# üîê **Check-In Logic**\n\nWhen check-in is triggered:\n\n1. The system finds the booking by ID\n    \n2. If the booking does not exist ‚Üí **404 Not Found**\n    \n3. If the booking is still in `\"unconfirmed\"` status:\n    \n    - `paid` is set to **true**\n        \n    - `status` becomes `\"checked in\"`\n        \n    - Booking is saved\n        \n4. If the booking is already checked-in or checked-out:\n    \n    - The system simply returns the existing booking\n        \n    - No changes are made  \n          \n        (Check-in will NOT be duplicated)\n        \n\n---\n\n# üß≠ **How to Use**\n\n```\nPOST /bookings/check-in/6904f9b6ed98751c87ee0033\nAuthorization: Bearer <admin-or-superadmin-token>\n\n ```\n\nNo request body is required.\n\n---\n\n# üì§ **Successful Response (201)**\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"_id\": \"...\",\n    \"status\": \"checked in\",\n    \"paid\": true,\n    \"userId\": { ... },\n    \"cabinId\": { ... },\n    ...\n  }\n}\n\n ```\n\n- User and cabin references are populated for convenience.\n    \n\n---\n\n# ‚ùó **When It Fails**\n\n| Condition | Response |\n| --- | --- |\n| Booking not found | 404 |\n| Unauthorized role | 403 |\n| Missing token | 401 |\n| Invalid booking ID | 400 |\n\n---\n\n# üß† **Important Notes**\n\n- Check-in is an admin-side action ‚Äî **users cannot check themselves in**.\n    \n- Only `\"unconfirmed\"` bookings can transition to `\"checked in\"`.\n    \n- Check-in automatically marks the booking as **paid**.\n    \n- If already checked-in or checked-out, the call is safe and simply returns the booking."
					},
					"response": []
				},
				{
					"name": "check out",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{URL}}/bookings/check-out/{{id}}",
							"host": [
								"{{URL}}"
							],
							"path": [
								"bookings",
								"check-out",
								"{{id}}"
							]
						},
						"description": "# üîµ **POST /bookings/check-out/:id**\n\n### **Endpoint**\n\n```\nPOST /bookings/check-out/:id\n\n ```\n\n---\n\n# üë• **Who Can Use This Endpoint?**\n\n### ‚úÖ Admin\n\n### ‚úÖ Super Admin (spadmin)\n\n### ‚ùå Regular User\n\nThis is a **staff-only operational action**.\n\n---\n\n# üéØ **Purpose**\n\nThis route is used to officially **check out a guest**, marking the end of their stay.  \n  \nIt finalizes the booking and ensures the booking is marked as **paid**.\n\n---\n\n# üîê **Check-Out Logic (Correct Version)**\n\n1. The booking is found using the provided ID.\n    \n2. If it does not exist ‚Üí **404 Booking not found**.\n    \n3. Check-out **only happens if the booking is currently** _**checked in**_**.**\n    \n4. When the status is `\"checked in\"`:\n    \n    - `status` becomes `\"checked out\"`\n        \n    - `paid` becomes `true`\n        \n    - Booking is saved\n        \n5. If the booking is **unconfirmed** or **already checked out**,  \n    **no changes are made** ‚Äî the API simply returns the existing booking.\n    \n\nThis ensures staff cannot check-out someone who never checked in.\n\n---\n\n# üß≠ **How to Use**\n\n```\nPOST /bookings/check-out/6904f9b6ed98751c87ee0033\nAuthorization: Bearer <admin-or-superadmin-token>\n\n ```\n\nThere is **no request body**.\n\n---\n\n# üì§ **Successful Response (201)**\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"_id\": \"...\",\n    \"status\": \"checked out\",\n    \"paid\": true,\n    \"userId\": { ... },\n    \"cabinId\": { ... },\n    ...\n  }\n}\n\n ```\n\n- Contains populated `userId` and `cabinId`\n    \n- If the booking was NOT in `\"checked in\"` state, it simply returns the booking unchanged\n    \n\n---\n\n# ‚ùó When It Fails\n\n| Condition | Status Code | Description |\n| --- | --- | --- |\n| Booking not found | 404 | Invalid or deleted booking |\n| Unauthorized role | 403 | Admin or super admin only |\n| Missing token | 401 | Authentication required |\n\n---\n\n# üß† **Important Things to Remember**\n\n- Only **\"checked in\"** bookings can be checked out.\n    \n- Check-out marks the booking as **paid**, even if it was unpaid before.\n    \n- Admin & Super Admin can check-out any booking.\n    \n- No changes occur when:\n    \n    - Booking is still `\"unconfirmed\"`\n        \n    - Booking is already `\"checked out\"`\n        \n\nThe route remains **safe and repeatable**."
					},
					"response": []
				}
			],
			"description": "# üè® **Bookings Module ‚Äî Overview**\n\nThe **Bookings Module** is responsible for handling all cabin reservation activity across _The World Oasis_ platform.  \n  \nIt ensures:\n\n- Only valid users can book\n    \n- Cabin availability is enforced\n    \n- Business rules (min/max nights) are applied\n    \n- Overlapping bookings are prevented\n    \n- Pricing is calculated automatically\n    \n- Extra services (like breakfast) are billed\n    \n- Sales and totals are generated automatically\n    \n\nBookings are **validated, calculated, and processed automatically** during creation.\n\n---\n\n# üß© **Booking Model ‚Äî Field Breakdown**\n\nEach booking consists of the following major fields:\n\n---\n\n## üë§ **userId**\n\n- **Type:** ObjectId (User reference)\n    \n- **Required:** Yes\n    \n- Represents the customer making the booking.\n    \n- User must:\n    \n    - Be a **regular user** (role = `\"user\"`)\n        \n    - Have **active** status\n        \n\nEmployees (admin/spadmin) **cannot** book cabins.\n\n---\n\n## üè† **cabinId**\n\n- **Type:** ObjectId (Cabin reference)\n    \n- **Required:** Yes\n    \n- Represents the cabin being reserved.\n    \n\n---\n\n## üìÖ **startDate & endDate**\n\nBoth fields are **required** and represent the booking period.\n\n### Validations automatically enforced:\n\n- `endDate` must be after `startDate`\n    \n- Duration must satisfy:\n    \n    - **minNights** (from Settings)\n        \n    - **maxNights** (from Settings)\n        \n\n### Conflict Prevention\n\nBefore saving, the system checks for **bookingConflicts** ensuring:\n\n- No overlapping bookings for the same cabin\n    \n- No date clashes for the selected period\n    \n\n---\n\n## üßë‚Äçü§ù‚Äçüßë **noOfUsers**\n\n- **Required**\n    \n- Must NOT exceed the cabin‚Äôs maximum **capacity**.\n    \n- If exceeded ‚Üí booking is rejected.\n    \n\n---\n\n## üßæ **status**\n\nBooking lifecycle states:\n\n| Status | Meaning |\n| --- | --- |\n| **unconfirmed** | Default, newly created |\n| **checked in** | Guest has arrived |\n| **checked out** | Guest has left |\n\nThe status flows are handled through admin routes.\n\n---\n\n## üíµ **Pricing Fields (Auto-calculated)**\n\nThese are **never provided by the client**.  \n  \nThey are computed automatically based on cabin price, discount, settings, dates, and breakfast selection:\n\n### **sales**\n\nBase cost = `(cabin.price - cabin.discount) \\* days`\n\n### **extraSales**\n\nAdditional cost for breakfast ‚Üí  \n`setting.breakfastPrice \\* days`  \n_(Only if breakFast = true)_\n\n### **totalSales**\n\n`totalSales = sales + extraSales`\n\n---\n\n## üç≥ **breakFast**\n\n- Boolean\n    \n- Default: `false`\n    \n- If true ‚Üí extra charges are added.\n    \n\n---\n\n## üìÜ **bookedAt**\n\n- Auto-set timestamp when booking is created.\n    \n\n---\n\n## üí≥ **paid**\n\n- Boolean\n    \n- Tracks whether the booking has been paid or not.\n    \n\n---\n\n## üìù **observation**\n\n- Optional internal notes (e.g., customer requests, special instructions).\n    \n\n---\n\n## üìÖ **paymentDate**\n\n- Timestamp of when payment was completed.\n    \n\n---\n\n# üîê **Core Validations Automatically Performed**\n\nWhen a booking is created:\n\n### 1)Check if **cabin**, **user**, and **settings** exist\n\nIf any is missing ‚Üí booking fails.\n\n### 2)User must be:\n\n- Active\n    \n- Role = `\"user\"`\n    \n\nAdmins/spadmins **cannot** create bookings.\n\n### 3)Capacity check\n\nCannot exceed cabin.capacity.\n\n### 4)Nights validation (from Settings)\n\n- Must be ‚â• minNights\n    \n- Must be ‚â§ maxNights\n    \n\n### 5)Overlapping bookings prevented\n\n`bookingConflicts(this)` ensures dates do not conflict.\n\n### 6)Automatic price calculation\n\nsales, extraSales, totalSales are computed."
		},
		{
			"name": "My Bookings",
			"item": [
				{
					"name": "my-booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/my-bookings/69045beb835d92574095e1ae",
							"host": [
								"{{URL}}"
							],
							"path": [
								"my-bookings",
								"69045beb835d92574095e1ae"
							]
						},
						"description": "# üìò **GET /my-bookings/:bookingId**\n\n### **Endpoint**\n\n```\nGET /my-bookings/{bookingId}\n\n ```\n\n### **Example**\n\n```\nGET /my-bookings/69045beb835d92574095e1ae\nAuthorization: Bearer <user-token>\n\n ```\n\n---\n\n# üéØ **Purpose**\n\nThis route allows a logged-in user to **retrieve the full details of one specific booking they created**.\n\nIt is part of the user-only booking management flow.\n\n---\n\n# üë• **Who Can Use This Route?**\n\n### ‚úÖ Regular User (role = \"user\")\n\nCan access _only their own bookings_.\n\n### ‚ùå Admin / Super Admin\n\nNot allowed ‚Äî admins have a separate booking module.\n\n### ‚ùå Unauthenticated Users\n\nNot allowed.\n\n---\n\n# üîê **Ownership Protection**\n\nThe system ensures that:\n\n- The booking must belong to the **current logged-in user**\n    \n- If the booking does **not** belong to the user, the system returns:  \n    **404 Not Found** (not 403)\n    \n\nThis prevents users from detecting other users‚Äô booking IDs.\n\nOwnership is always enforced.\n\n---\n\n# üß© **What This Route Returns**\n\nA booking document containing safely exposed fields, including (depending on your population rules):\n\n- Booking ID\n    \n- Cabin information\n    \n- Dates (startDate, endDate)\n    \n- Number of guests\n    \n- Breakfast selection\n    \n- Total price fields\n    \n- Status (unconfirmed / checked in / checked out)\n    \n- User details (limited and safe subset)\n    \n\nSensitive internal fields are automatically excluded.\n\n---\n\n# üß≠ **How to Use**\n\n```\nGET /my-bookings/69045beb835d92574095e1ae\nAuthorization: Bearer <token>\n\n ```\n\nNo body is required.\n\n---\n\n# üì§ **Successful Response (200)**\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"booking\": {\n      \"_id\": \"69045beb835d92574095e1ae\",\n      \"cabinId\": { ... },\n      \"startDate\": \"...\",\n      \"endDate\": \"...\",\n      \"noOfUsers\": 3,\n      \"breakFast\": true,\n      \"totalSales\": 4200,\n      \"status\": \"unconfirmed\"\n    }\n  }\n}\n\n ```\n\n(Exact fields depend on your population rules.)\n\n---\n\n# ‚ùó When It Fails\n\n| Condition | Response |\n| --- | --- |\n| Booking does not exist | 404 |\n| Booking belongs to another user | 404 |\n| Token missing or invalid | 401 |\n| User is not role `\"user\"` | 403 |\n\n---\n\n# üß† **Key Points to Remember**\n\n- Users can only fetch _their own_ bookings\n    \n- Unauthorized access returns **404**, not 403\n    \n- No admin or staff access\n    \n- Ideal for user dashboard booking detail pages\n    \n- Safe-field filtering ensures privacy"
					},
					"response": []
				},
				{
					"name": "my-bookings",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/my-bookings",
							"host": [
								"{{URL}}"
							],
							"path": [
								"my-bookings"
							],
							"query": [
								{
									"key": null,
									"value": "",
									"disabled": true
								}
							]
						},
						"description": "# **GET /my-bookings**\n\n### **Endpoint**\n\n```\nGET /my-bookings\n\n ```\n\n### **Purpose**\n\nReturns a **paginated list** of bookings belonging to the logged-in user.\n\n### **Who Can Use**\n\n- ‚úî Regular users\n    \n- ‚ùå Admin / Super Admin\n    \n- ‚ùå Unauthenticated users\n    \n\n### **Available Query Parameters**\n\n| Query | Description |\n| --- | --- |\n| `page` | Page number (default 1) |\n| `limit` | Results per page (default 10) |\n| `fields` | Select specific fields to include |\n| `phase` | Filter by booking status (`checked-in`, `checked-out`, `unconfirmed`) |\n| `sortBy` | Sort by date or price |\n\n### **Security**\n\nThe system automatically injects:\n\n```\nuserId = currentUser._id\n\n ```\n\nUsers **cannot** view bookings belonging to anyone else.\n\n### **Success Response (200)**\n\nReturns only the user‚Äôs bookings."
					},
					"response": []
				},
				{
					"name": "delete my-booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{URL}}/my-bookings/6905bff76dad17047fdb9653",
							"host": [
								"{{URL}}"
							],
							"path": [
								"my-bookings",
								"6905bff76dad17047fdb9653"
							]
						},
						"description": "# **‚ö†Ô∏è /my-bookings/:bookingId**\n\n### **Endpoint**\n\n```\nDELETE /my-bookings/:bookingId\n\n ```\n\n### **Purpose**\n\nAllows the user to **cancel/delete** their own booking.\n\n### **Who Can Use**\n\n- ‚úî Regular user\n    \n- ‚ùå Admin / Super Admin\n    \n\n### **Security**\n\n- Users can delete **only their own** bookings\n    \n- Attempting to delete someone else‚Äôs booking returns **404**, not 403\n    \n\n### **Success Response (204 No Content)**\n\n```\n{\n  \"status\": \"success\",\n  \"data\": null\n}\n\n ```"
					},
					"response": []
				},
				{
					"name": "update my-booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\r\n    \"breakFast\": true\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/my-bookings/69045beb835d92574095e1ae",
							"host": [
								"{{URL}}"
							],
							"path": [
								"my-bookings",
								"69045beb835d92574095e1ae"
							]
						},
						"description": "# **‚≠ê /my-bookings/:bookingId ‚Äî Update My Booking**\n\n### **Endpoint**\n\n```\nPATCH /my-bookings/:bookingId\n\n ```\n\n### **Purpose**\n\nAllows the user to update selected fields of **their own** booking.\n\n### **Who Can Use**\n\n- ‚úî Regular user\n    \n- ‚ùå Admin / Super Admin\n    \n\n### **Allowed Update Fields**\n\nUsers can update only:\n\n- `cabinId`\n    \n- `startDate`\n    \n- `endDate`\n    \n- `noOfUsers`\n    \n- `breakFast`\n    \n- `observation`\n    \n\n### **Restrictions**\n\n‚ùó Users **cannot** update a **paid** booking  \n  \n(Already completed bookings are locked)\n\n‚ùó Users cannot update:\n\n- Price fields\n    \n- Status\n    \n- Any administrative fields\n    \n\n### **Security**\n\nIf the booking does not belong to the user ‚Üí **404**.\n\n### **Success Response (201)**\n\nReturns the updated booking with recalculated pricing."
					},
					"response": []
				},
				{
					"name": "create my-booking",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\r\n\"cabinId\": \"68cbb2936c7dae7b9b06239b\",\r\n\"startDate\": \"2025-12-01T00:00:00.000Z\",\r\n\"endDate\": \"2025-12-11T00:00:00.000Z\",\r\n\"noOfUsers\": 3,\r\n\"observation\": \"Provide cab service on arrival\",\r\n\"breakFast\": true\r\n\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{URL}}/my-bookings/",
							"host": [
								"{{URL}}"
							],
							"path": [
								"my-bookings",
								""
							]
						},
						"description": "# **POST /my-bookings ‚Äî Create a Booking**\n\n### **Endpoint**\n\n```\nPOST /my-bookings\n\n ```\n\n### **Purpose**\n\nCreates a new booking for the logged-in user.\n\n### **Who Can Use**\n\n- ‚úî Regular user\n    \n- ‚ùå Admin / Super Admin\n    \n\n### **Behavior**\n\n- The user **cannot** provide `userId`\n    \n- The booking is always assigned to the **existing logged-in user**\n    \n- All business rules apply (capacity, min/max nights, conflicts, pricing, active user)\n    \n\n### **Required Body Fields**\n\n| Field | Type | Description |\n| --- | --- | --- |\n| `cabinId` | ObjectId | Cabin to book |\n| `startDate` | Date | Check-in date |\n| `endDate` | Date | Check-out date |\n| `noOfUsers` | Number | Guest count |\n| `breakFast` | Boolean | Optional breakfast |\n| `observation` | String | Optional notes |\n\n### **Success Response (201)**\n\nReturns the created booking with populated cabin/user data."
					},
					"response": []
				}
			],
			"description": "# üë§ **My Bookings Module**\n\nThe **My Bookings Module** is designed exclusively for **regular users** to manage their own reservations in a secure and isolated way.  \n  \nEverything in this module operates strictly on the **current logged-in user**, ensuring complete privacy and preventing unauthorized access to other users' bookings.\n\nThis module provides users with the ability to:\n\n- **Create** bookings for themselves\n    \n- **View** all their active and past bookings\n    \n- **Fetch** a specific booking they made\n    \n- **Modify** their own upcoming bookings\n    \n- **Cancel/Delete** their upcoming bookings\n    \n\nAll operations within this module enforce strong ownership checks, making sure:\n\n### üîí Users can only see and manage **their own** bookings.\n\n### üîí No user can access or even detect the existence of another user‚Äôs booking.\n\n### üîí User identity is automatically bound to every request, preventing impersonation.\n\n---\n\n# üéØ **Key Principles of the My Bookings Module**\n\n### **1\\. User-Scoped Access Only**\n\nEvery route automatically restricts results to:\n\n```\nbookings where userId === currentUser\n\n ```\n\nThis ensures complete isolation.\n\n### **2\\. Automatic User Binding**\n\nWhen creating or modifying bookings, the system always uses the logged-in user‚Äôs ID.  \n  \nClients **cannot change or override** the userId.\n\n### **3\\. Limited Editing Permissions**\n\nUsers can update **only a safe subset of fields**, and **cannot** modify sensitive system-calculated fields like pricing or payment.\n\n### **4\\. Booking Security**\n\nIf a user tries to access a booking they don‚Äôt own:\n\n- The system responds with **404 Not Found**  \n      \n    (not 403)  \n      \n    to avoid revealing other users' booking IDs.\n    \n\n### **5\\. Different from Admin Bookings**\n\nThis module is completely separate from staff/admin booking tools.\n\n| Feature | Users | Admin/SpAdmin |\n| --- | --- | --- |\n| Create booking for self | ‚úî | ‚ùå (admin panel uses `/bookings`) |\n| View all bookings | ‚ùå | ‚úî |\n| Check-in / Check-out | ‚ùå | ‚úî |\n| Modify any booking | ‚ùå | ‚úî |\n| Modify own booking | ‚úî | ‚ùå |\n\n---\n\n# üì¶ **What This Module Contains**\n\nThe module includes user-friendly versions of:\n\n- **GET /my-bookings** ‚Äî List of user‚Äôs bookings\n    \n- **POST /my-bookings** ‚Äî Create a new booking\n    \n- **GET /my-bookings/{id}** ‚Äî Get details of a single booking\n    \n- **PATCH /my-bookings/{id}** ‚Äî Update user‚Äôs booking\n    \n- **DELETE /my-bookings/{id}** ‚Äî Cancel user‚Äôs booking\n    \n\nAll of these routes enforce:\n\n- Authentication\n    \n- User role = `\"user\"`\n    \n- Strict ownership\n    \n\n---\n\n# üß† **Why This Module Exists**\n\nThis module exists to:\n\n- Protect user privacy\n    \n- Keep user operations separate from admin operations\n    \n- Simplify booking management for users\n    \n- Prevent misuse or manipulation of booking data\n    \n- Provide a clear, dedicated space for customers to view and manage their reservations"
		},
		{
			"name": "Dashboard",
			"item": [
				{
					"name": "getInsights",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{URL}}/dashboard/7",
							"host": [
								"{{URL}}"
							],
							"path": [
								"dashboard",
								"7"
							]
						},
						"description": "# üìä **GET /dashboard/:period**\n\n### **Endpoint**\n\n```\nGET /dashboard/:period\n\n ```\n\n### **Param**\n\n`period` ‚Üí Number of past days to analyze  \n  \nExamples:\n\n- `/dashboard/7` ‚Üí Last 7 days\n    \n- `/dashboard/30` ‚Üí Last 30 days\n    \n- `/dashboard/90` ‚Üí Last 90 days\n    \n\nThe selected period defines the date range over which all insights are calculated.\n\n---\n\n# üë• **Who Can Access This Route?**\n\n### ‚úî Admin\n\n### ‚úî Super Admin (spadmin)\n\n### ‚úñ Regular User\n\n### ‚úñ Unauthenticated users\n\nDashboard insights contain sensitive business data, so only staff roles can access them.\n\n---\n\n# üéØ **Purpose of This Endpoint**\n\nThis route provides a **complete set of dashboard analytics** in **one API call**.  \n  \nIt is specifically designed for the **Admin Dashboard**, allowing staff to quickly get all essential performance metrics without multiple requests.\n\nThe system runs a combined aggregation pipeline and returns **all insights together**, making the dashboard fast and efficient.\n\n---\n\n# üì¶ **What Insights Are Included**\n\nThe response includes several calculated metrics based on the selected period.  \n  \nThe insights provided are:\n\n---\n\n### 1Ô∏è‚É£ **Total Bookings**\n\nNumber of bookings created in the selected period.\n\n---\n\n### 2Ô∏è‚É£ **Total Check-ins**\n\nCount of check-ins and the total revenue from those checked-in bookings.\n\n---\n\n### 3Ô∏è‚É£ **Sales by Date**\n\nDaily sales totals within the selected date range ‚Äî used for charts or revenue graphs.\n\n---\n\n### 4Ô∏è‚É£ **Occupancy Rate**\n\nPercentage of cabin occupancy based on total available cabin nights vs booked nights.\n\n---\n\n### 5Ô∏è‚É£ **Duration Summary**\n\nBreakdown of stay lengths (short stays, long stays, etc.) across all bookings.\n\n---\n\n### 6Ô∏è‚É£ **Daily Movements**\n\nDaily operational activity, including:\n\n- Arrivals\n    \n- Departures\n    \n- Stay-overs\n    \n\nThis is useful for understanding daily traffic and guest flow.\n\n---\n\n# üß≠ **How to Use**\n\n```\nGET /dashboard/:period\nAuthorization: Bearer <admin-or-superadmin-token>\n\n ```\n\nExample:\n\n```\nGET /dashboard/30\n\n ```\n\nNo request body is required.\n\n---\n\n# üì§ **Response Format (General Structure)**\n\n```\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"totalBookings\": [...],\n    \"totalCheckIns\": [...],\n    \"salesByDate\": [...],\n    \"occupancyRate\": [...],\n    \"durationSummary\": [...],\n    \"dailyMovements\": [...]\n  }\n}\n\n ```\n\nThe exact structure depends on your faceted response.\n\n---\n\n# ‚ùó Error Responses\n\n| Code | Cause |\n| --- | --- |\n| **401** | Missing or invalid token |\n| **403** | User is not admin/spadmin |\n| **400** | Invalid period value (not a number) |\n\n---\n\n# üß† **Key Notes**\n\n- All insights are calculated from **real booking data**\n    \n- The endpoint uses a **single aggregation pipeline** with multiple facets\n    \n- No need for multiple API calls ‚Äî everything comes in one response\n    \n- The `period` parameter directly controls the date range\n    \n- Designed specifically for the admin dashboard and analytics feature"
					},
					"response": []
				}
			],
			"description": "# üìä **Dashboard Module**\n\nThe **Dashboard Module** provides real-time business insights for administrators and super administrators.  \n  \nIt aggregates booking, sales, occupancy, and operational activity into a **single API request**, giving management a clear picture of business performance over any chosen time period.\n\nThis module powers the **admin dashboard**, enabling staff to monitor:\n\n- How many bookings occurred\n    \n- How many guests checked in\n    \n- Total revenue generated\n    \n- Occupancy rate across cabins\n    \n- Booking duration breakdown\n    \n- Daily activity movements\n    \n- Sales grouped by date\n    \n\nAll of this is computed using several MongoDB aggregation pipelines and returned in one consolidated response.\n\n---\n\n# üë• **Who Can Access the Dashboard Module?**\n\n### **‚úî Super Admin (****`spadmin`****)**\n\nFull access\n\n### **‚úî Admin**\n\nAccess allowed\n\n### **‚ùå Regular User (****`user`****)**\n\nNot allowed ‚Äî the dashboard contains sensitive business insights and cannot be viewed by customers.\n\n### **‚ùå Unauthenticated Requests**\n\nNot allowed\n\nOnly authenticated admin roles can access this module.\n\n---\n\n# üéØ **Purpose of the Dashboard Module**\n\nThe dashboard exists to give managers a **centralized analytics view**.  \n  \nInstead of calling multiple endpoints, the system provides **all insights at once**:\n\n- Booking performance\n    \n- Revenue insights\n    \n- Occupancy metrics\n    \n- Operational movements\n    \n- Stay duration patterns\n    \n- Check-in data\n    \n- Historical sales trends\n    \n\nThis makes it ideal for:\n\n- Admin dashboards\n    \n- Management analytics screens\n    \n- Performance monitoring pages\n    \n- Business intelligence tools\n    \n\n---\n\n# üîÑ **How the Dashboard Module Works**\n\nWhen a request is made to the dashboard route:\n\n```\nGET /dashboard/:period\n\n ```\n\nThe backend triggers a **multi-facet aggregation pipeline** that simultaneously executes all analytics queries and bundles the results into a single JSON response.\n\nThe pipeline calculates:\n\n### ‚úî Daily Movements\n\nBookings starting or ending today  \n\ndaily-movements\n\n### ‚úî Occupancy Rate\n\nPercentage of cabin occupancy over the given period  \n\noccupancyRate\n\n### ‚úî Duration Summary\n\nDistribution of stays (2 nights, 3 nights, 4‚Äì5, 8‚Äì14, etc.)  \n\ndurationSummary\n\n### ‚úî Sales by Date\n\nRevenue trends for each date in the selected period  \n\nsalesByDate\n\n### ‚úî Total Bookings\n\nNumber of new bookings during the selected period  \n\ntotalBookings\n\n### ‚úî Total Check-ins\n\nNumber of check-ins + total revenue for checked-in bookings  \n\ntotalCheckIns\n\nAll of these are combined using a `$facet` aggregation:  \n\naggregationPipeline\n\nThis means **one API call returns every dashboard insight**, making it fast, efficient, and ideal for a single-load dashboard UI.\n\n---\n\n# üìà **Supported Period Values**\n\nThe `:period` parameter indicates how many **past days** should be analyzed.\n\nExample values:\n\n- `7` ‚Üí last 7 days\n    \n- `30` ‚Üí last 30 days\n    \n- `90` ‚Üí last 90 days\n    \n- `365` ‚Üí last 1 year\n    \n\nExample request:\n\n```\nGET /dashboard/30\nAuthorization: Bearer <admin-token>\n\n ```\n\n---\n\n# üß† **Key Characteristics of the Dashboard Module**\n\n### ‚úî All insights in a single API call (via `$facet`)\n\n### ‚úî Accurate date-range filtering using `startOfDay` and `subDays`\n\n### ‚úî Excludes soft or canceled data‚Äîuses live booking data\n\n### ‚úî Automatically considers cabin count for occupancy calculations\n\n### ‚úî Sales values automatically aggregated\n\n### ‚úî Suitable for charts, widgets, and admin analytics"
		},
		{
			"name": "Home",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "text/html",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{URL}}/",
					"host": [
						"{{URL}}"
					],
					"path": [
						""
					]
				}
			},
			"response": []
		}
	],
	"auth": {
		"type": "bearer"
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	]
}